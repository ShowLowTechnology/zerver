{"name":"Zerver","tagline":"modern html5 webapp server","body":"Zerver is a lightweight Node.js-based webserver that lets you seamlessly make server API calls as if they were a library on the client. The goal is to provide a developer-focused toolset and remove all the boilerplate involved in serving a webapp.\r\n\r\n### Install\r\n\r\n```sh\r\nnpm install -g zerver\r\n# or add zerver to your package.json dependencies and run npm install\r\n```\r\n\r\n# Basic usage\r\n\r\nLet's say you have a directory of this structure.\r\n\r\n```\r\nwebsite-dir/index.html\r\nwebsite-dir/zerver/MyAPI.js\r\n```\r\n\r\nEverything in `website-dir` will be served as static content except for code in `zerver/` which will run on the server.\r\nOnly files on the topmost level of the zerver folder will be saved as api's i.e. files in subfolders under zerver will not be used unless they are specifically required in one of the main api files.\r\n```js\r\n// in website-dir/zerver/MyAPI.js\r\n// this runs on the server\r\nexports.logStuff = function (str) {\r\n    console.log(str); // 'hi from client'\r\n    callback('hi from server');\r\n};\r\n```\r\n\r\n```html\r\n<!-- in website-dir/index.html -->\r\n<!-- this runs in the browser -->\r\n<script src=\"zerver/MyAPI.js\"></script>\r\n<script>\r\n    MyAPI.logStuff('hi from client', function (str) {\r\n        console.log(str); // \"hi from server\"\r\n    });\r\n</script>\r\n```\r\n\r\n```sh\r\n# run the server\r\nzerver website-dir\r\n# go to http://localhost:5000/ to view the magic\r\n```\r\n\r\n### What just happened?\r\n\r\n`MyAPI.logStuff` automatically serializes the arguments of the function call and makes an AJAX request to the server. The server runs the function in `website-dir/zerver/MyAPI.js` and responds to the client in a similar way.\r\n\r\nAny amount of arguments can be used in the function calls as long as they are JSON stringify-able (with the exception of the callback function).\r\n\r\nNote: any server code in a subdirectory of `website-dir/zerver` will not be available for import on the client allowing for libraries of private server functionality.\r\n\r\n### Require syntax\r\n\r\n```html\r\n<!-- in website-dir/index.html -->\r\n<script src=\"/zerver/require.js\"></script>\r\n<script>\r\n    var MyAPI = require('MyAPI');\r\n    MyAPI.logStuff('hi from client', function (str) {\r\n        console.log(str); // \"hi from server\"\r\n    });\r\n</script>\r\n```\r\n\r\n## Zerver options\r\n\r\n```sh\r\n# General usage\r\nzerver [options] website-dir\r\n\r\n# run server on a different port\r\nzerver --port=8000 website-dir\r\n\r\n-r, --refresh\r\n# Any webpage being viewed that has a Zerver script on it (`website-dir/index.html`)\r\n# will automatically refresh when any of its code is edited.\r\n# You can edit code and immediately see feedback on how it effects your running webapp.\r\n\r\n-c, --cli\r\n# Creates a js shell to communicate with remote clients, press tab to enable.\r\n# Any code run in this shell will be run on the client.\r\n\r\n-V, --verbose\r\n# Enable verbose request logging\r\n\r\n-l, --less\r\n# Automatically compile less into css\r\n# Requires the less node module to work run: npm install less\r\n\r\n-p, --production\r\n# Enables production mode (caching, concat, minfiy, gzip, etc)\r\n```\r\n\r\n### Command Line Interface\r\n\r\nThe command line interface (the `cli` flag) allows you to communicate with the client during development\r\n\r\nFor example:\r\n\r\n```sh\r\nzerver -cli website-dir\r\n\r\n# Press tab to enable the cli\r\n>>>\r\n# The following line will cause all clients listening to the server to refresh\r\n>>> window.location.reload();\r\n\r\n# You can also log things from the client\r\n# The following line logs all the functions\r\n# that are available in 'MyAPI'\r\n>>> console.log(Object.keys(MyAPI));\r\nlog: [\"function1FromMyApi\", \"function2FromMyApi\"]\r\n# Since anything that is logged on the client gets\r\n# sent to the server you can see the result right in the command line\r\n```\r\n\r\n## Production mode\r\n\r\nPassing the `--production` flag on startup enables zervers production features.\r\n\r\n### Inlining files\r\n\r\nGiven the following link\r\n\r\n```html\r\n<link rel=\"stylesheet\" href=\"/css/app.min.css?inline=1\">\r\n```\r\n\r\nZerver will create a `<style>` tag in place and place the css there instead, reducing the amount of requests to load files.\r\n\r\nThe same can be done with images inside the css file\r\n\r\n```css\r\nbackground-image: url(/img/background.png?inline=1);\r\n```\r\n\r\n### Gzip and minifying\r\n\r\nGiven the following files in your manifest.\r\n\r\n```sh\r\n# zerver:js/main.min.js\r\njs/cards.js\r\njs/app.js\r\njs/main.js\r\n# /zerver\r\n```\r\n\r\nAnd the following in your HTML file:\r\n\r\n```html\r\n<!-- zerver:js/main.min.js -->\r\n<script src=\"js/cards.js\"></script>\r\n<script src=\"js/app.js\"></script>\r\n<script src=\"js/main.js\"></script>\r\n<!-- /zerver -->\r\n```\r\n\r\nWhen the server is run on production these files will be gzipped & minified into a file called `main.min.js`\r\n\r\n### Manifest file\r\n\r\nZerver has automatic support for HTML5 appcache manifests. This means that Zerver will automatically detect their presence and make sure that clients always update when files referenced in the manifest have changed.\r\nThe cache manifest file is a simple text file that lists the resources the browser should cache for offline access. It should be referenced at the top of your html file like this:\r\n\r\n```html\r\n<html manifest=\"cache.manifest\">\r\n...\r\n</html>\r\n```\r\nThe cache manifest allows you to specify which files the browser should cache and make available to offline users. Your app will load and work correctly, even if the user presses the refresh button while they're offline.\r\n\r\nThe advantage that Zerver brings with the cache manifest is that it will refresh the cache whenever files are changed.\r\nThis fixes the main drawback of developing with a manifest as now you will always be working with the most up to date versions of the edited files.\r\n\r\n### Default options\r\n\r\nYou can specify default options in an environment variable, to avoid having to type them every time or having different setups for different environments in which the code will run\r\n```sh\r\nexport ZERVER_FLAGS='-drl'\r\n```\r\n\r\n### Running as an npm script\r\n\r\nAnother way to save time when running zerver is to add your default run configurations to an npm script in your `package.json`\r\n\r\n```json\r\n{\r\n  \"name\"    : \"zerver-sample\" ,\r\n  \"version\" : \"0.0.1\" ,\r\n  \"engines\" : {\r\n    \"node\" : \"0.10.21\" ,\r\n    \"npm\"  : \"1.3.11\"\r\n  },\r\n  \"dependencies\" : {\r\n    \"zerver\" : \"0.14.1\"\r\n  },\r\n  \"scripts\" : {\r\n    \"start\" : \"zerver -rlc web\"\r\n  }\r\n}\r\n```\r\nSample package.json file for a zerver application\r\n\r\nThis setup allows you to simply enter `npm start` to run the command `zerver -rlc web`.\r\n\r\n# ExpressJS integration\r\n\r\nZerver integrates well with Express, providing the same functionality to any existing webapp.\r\n\r\n```js\r\n// \"app\" is an ExpressJS app instance\r\nvar zerver = require('zerver');\r\napp.use( zerver.middleware('path/to/zerver/scripts', 'url/to/zerve/at') );\r\n```\r\n\r\nAlong with the rest of your Express app, Zerver scripts will be accessible the specified path (`url/to/zerve/at`) for importing into your client-side code.\r\n\r\n# Node module\r\n\r\nA convenient tool for testing and server-to-server integration is the NodeJS Zerver module.\r\n\r\n```js\r\nvar zerver = require('zerver');\r\n\r\nzerver.get('http://localhost:5000/zerver/', function (myzerver) {\r\n    myzerver.MyAPI.logStuff('hi from another server', function (str, data) {\r\n        console.log(str); // \"hi from server\"\r\n    });\r\n});\r\n```\r\n\r\n### Script names\r\n\r\nZerver scripts can be globalised on the client under whatever name you please. If you are afraid of object name collisions simply define the query argument `name` for the script and it will be globalised as such.\r\n\r\n```html\r\n<!-- in website-dir/index.html -->\r\n<script src=\"zerver/MyAPI.js?name=SomeOtherAPI\"></script>\r\n<script>\r\n    SomeOtherAPI.logStuff('hi from client', function (str) {\r\n        console.log(str); // \"hi from server\"\r\n    });\r\n</script>\r\n```\r\n### Error handling\r\n\r\n```html\r\n<!-- in website-dir/index.html -->\r\n<script src=\"zerver/MyAPI.js\"></script>\r\n<script>\r\n    MyAPI.logStuff('hi from client', function (str) {\r\n        // this === MyAPI\r\n        console.log(str); // \"hi from server\"\r\n    }).error(function (err) {\r\n        // this === MyAPI\r\n        console.log(err); // error string explaining failure\r\n    });\r\n</script>\r\n```\r\n\r\n# Example apps\r\n\r\n[Basic app](https://github.com/jairajs89/zerver/tree/master/examples/basic-app)\r\n\r\n[Express app](https://github.com/jairajs89/zerver/tree/master/examples/express-app)\r\n","google":"UA-4073712-12","note":"Don't delete this file! It's used internally to help with page regeneration."}